# SMC Hardware CLI Tool

р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕Ър╕гр╕гр╕Чр╕▒р╕Фр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕зр╕Ър╕Др╕╕р╕бр╕ор╕▓р╕гр╣Мр╕Фр╣Бр╕зр╕гр╣М DS12/DS16 р╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕Ир╣Ир╕▓р╕вр╕вр╕▓р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤

## р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤

- ЁЯФН **р╕Хр╕гр╕зр╕Ир╕лр╕▓р╕Юр╕нр╕гр╣Мр╕Хр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤** - р╕Др╣Йр╕Щр╕лр╕▓р╣Бр╕ер╕░р╕гр╕░р╕Ър╕╕р╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕╡р╣Ир╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Бр╕▒р╕Ъ DS12/DS16
- ЁЯУК **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╕Кр╣Ир╕нр╕Зр╕вр╕▓** - р╣Гр╕Кр╣Йр╕Др╕│р╕кр╕▒р╣Ир╕З raw 0x80 р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕кр╕Цр╕▓р╕Щр╕░р╕Кр╣Ир╕нр╕Зр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
- ЁЯФУ **р╕Ыр╕ер╕Фр╕ер╣Зр╕нр╕Бр╕Кр╣Ир╕нр╕Зр╕вр╕▓** - р╣Гр╕Кр╣Йр╕Др╕│р╕кр╕▒р╣Ир╕З raw 0x81 р╣Ар╕Юр╕╖р╣Ир╕нр╕Ыр╕ер╕Фр╕ер╣Зр╕нр╕Бр╕Кр╣Ир╕нр╕Зр╣Ар╕Йр╕Юр╕▓р╕░
- ЁЯЫбя╕П **р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Чр╕▓р╕Зр╕Бр╕▓р╕гр╣Бр╕Юр╕Чр╕вр╣М** - р╕бр╕╡р╕гр╕░р╕Ър╕Ър╣Ар╕Хр╕╖р╕нр╕Щр╣Бр╕ер╕░ audit logging
- ЁЯМР **р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в** - р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕ер╕░р╕Бр╕▓р╕гр╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╣Ар╕Ыр╣Зр╕Щр╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в

## р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З

```bash
cd hardware-cli
npm install
npm run build
```

## р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### 1. р╕Фр╕╣р╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕╡р╣Ир╕бр╕╡

```bash
# р╕Фр╕╣р╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕бр╕кр╕│р╕лр╕гр╕▒р╕Ъ DS12/DS16
npm start list-ports

# р╕Фр╕╣р╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
npm start list-ports --all

# р╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф
npm start list-ports --all --verbose
```

### 2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╕Кр╣Ир╕нр╕Зр╕вр╕▓

```bash
# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░ (р╕лр╕▓р╕Юр╕нр╕гр╣Мр╕Хр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤)
npm start check-state

# р╕гр╕░р╕Ър╕╕р╕Юр╕нр╕гр╣Мр╕Хр╣Ар╕нр╕З
npm start check-state --port COM3

# р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф
npm start check-state --verbose
```

### 3. р╕Ыр╕ер╕Фр╕ер╣Зр╕нр╕Бр╕Кр╣Ир╕нр╕Зр╕вр╕▓

```bash
# р╕Ыр╕ер╕Фр╕ер╣Зр╕нр╕Бр╕Кр╣Ир╕нр╕Зр╕Чр╕╡р╣И 5
npm start unlock 5

# р╕гр╕░р╕Ър╕╕р╕Юр╕нр╕гр╣Мр╕Хр╣Ар╕нр╕З
npm start unlock 12 --port COM3

# р╕Вр╣Йр╕▓р╕бр╕Др╕│р╣Ар╕Хр╕╖р╕нр╕Щр╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в
npm start unlock 8 --force
```

## р╕Хр╕▒р╕зр╣Ар╕ер╕╖р╕нр╕Бр╕Чр╕▒р╣Ир╕зр╣Др╕Ы

- `-v, --verbose` - р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф
- `-t, --timeout <ms>` - р╕Бр╕│р╕лр╕Щр╕Ф timeout (р╕Др╣Ир╕▓р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ: 3000ms)
- `-p, --port <path>` - р╕гр╕░р╕Ър╕╕р╕Юр╕нр╕гр╣Мр╕Хр╣Ар╕нр╕З
- `-f, --force` - р╕Вр╣Йр╕▓р╕бр╕Др╕│р╣Ар╕Хр╕╖р╕нр╕Щ (р╕кр╕│р╕лр╕гр╕▒р╕Ъ unlock)

## р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д

```
hardware-cli/
тФЬтФАтФА src/
тФВ   тФЬтФАтФА commands/          # р╕Др╕│р╕кр╕▒р╣Ир╕З CLI
тФВ   тФВ   тФЬтФАтФА list-ports.ts
тФВ   тФВ   тФЬтФАтФА check-state.ts
тФВ   тФВ   тФФтФАтФА unlock.ts
тФВ   тФЬтФАтФА protocol/          # р╣Вр╕Ыр╕гр╣Вр╕Хр╕Др╕нр╕е DS12/DS16
тФВ   тФВ   тФЬтФАтФА constants.ts
тФВ   тФВ   тФЬтФАтФА packet-builder.ts
тФВ   тФВ   тФФтФАтФА parser.ts
тФВ   тФЬтФАтФА serial/            # р╕Бр╕▓р╕гр╕кр╕╖р╣Ир╕нр╕кр╕▓р╕гр╕нр╕Щр╕╕р╕Бр╕гр╕б
тФВ   тФВ   тФЬтФАтФА connection.ts
тФВ   тФВ   тФФтФАтФА port-detector.ts
тФВ   тФЬтФАтФА cli.ts            # р╕Ир╕╕р╕Фр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ CLI
тФВ   тФФтФАтФА index.ts          # exports р╕лр╕ер╕▒р╕Б
тФЬтФАтФА bin/                  # р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣И compile р╣Бр╕ер╣Йр╕з
тФЬтФАтФА package.json
тФЬтФАтФА tsconfig.json
тФФтФАтФА README.md
```

## р╣Вр╕Ыр╕гр╣Вр╕Хр╕Др╕нр╕е DS12/DS16

### р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ

- **0x80** - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╕Кр╣Ир╕нр╕Зр╕вр╕▓ (Status Request)
- **0x81** - р╕Ыр╕ер╕Фр╕ер╣Зр╕нр╕Бр╕Кр╣Ир╕нр╕Зр╕вр╕▓ (Unlock Slot)
- **0x8F** - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щ (Get Version)

### р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕нр╕Щр╕╕р╕Бр╕гр╕б

- **Baud Rate**: 19200
- **Data Bits**: 8
- **Stop Bits**: 1
- **Parity**: None (8N1)

### р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Бр╕Юр╣Зр╕Бр╣Ар╕Бр╣Зр╕Х

```
[STX][CMD][ASK][DATALEN][DATA...][CHECKSUM][ETX]
```

## р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Чр╕▓р╕Зр╕Бр╕▓р╕гр╣Бр╕Юр╕Чр╕вр╣М

тЪая╕П **р╕Др╕│р╣Ар╕Хр╕╖р╕нр╕Щр╕кр╕│р╕Др╕▒р╕Н**: р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕Щр╕╡р╣Йр╕Др╕зр╕Ър╕Др╕╕р╕бр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╕Чр╕▓р╕Зр╕Бр╕▓р╕гр╣Бр╕Юр╕Чр╕вр╣М

- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╕нр╕Щр╕╕р╕Нр╕▓р╕Хр╕Бр╣Ир╕нр╕Щр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
- р╕бр╕╡р╕гр╕░р╕Ър╕Ъ audit logging р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Ар╕Хр╕╖р╕нр╕Щр╣Ар╕Ыр╣Зр╕Щр╕ар╕▓р╕йр╕▓р╣Др╕Чр╕вр╕Хр╕▓р╕бр╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щр╕Бр╕▓р╕гр╣Бр╕Юр╕Чр╕вр╣М

## р╕Бр╕▓р╕гр╕Юр╕▒р╕Тр╕Щр╕▓

```bash
# р╕Юр╕▒р╕Тр╕Щр╕▓р╣Бр╕Ър╕Ъ watch mode
npm run dev

# Build
npm run build

# Test
npm test

# Lint
npm run lint
```

## р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М

### р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░
```
тЬЕ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╕кр╕│р╣Ар╕гр╣Зр╕И

р╕кр╕Цр╕▓р╕Щр╕░р╕Кр╣Ир╕нр╕Зр╕вр╕▓ (12 р╕Кр╣Ир╕нр╕З):
р╕Кр╣Ир╕нр╕Зр╕Чр╕╡р╣Ир╣Ар╕Ыр╕┤р╕Ф: 3, 7, 11
р╕Кр╣Ир╕нр╕Зр╕Чр╕╡р╣Ир╕Ыр╕┤р╕Ф: 1, 2, 4, 5, 6, 8, 9, 10, 12
```

### р╕Ыр╕ер╕Фр╕ер╣Зр╕нр╕Бр╕Кр╣Ир╕нр╕Зр╕вр╕▓
```
тЬЕ р╕Ыр╕ер╕Фр╕ер╣Зр╕нр╕Бр╕Кр╣Ир╕нр╕Зр╕Чр╕╡р╣И 5 р╕кр╕│р╣Ар╕гр╣Зр╕И
ЁЯФУ р╕Кр╣Ир╕нр╕Зр╕вр╕▓р╕Цр╕╣р╕Бр╕Ыр╕ер╕Фр╕ер╣Зр╕нр╕Бр╣Бр╕ер╣Йр╕з

MEDICAL: Slot 5 unlocked at 2/10/2025 22:23:55
```

## р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓

### р╣Др╕бр╣Ир╕Юр╕Ър╕Юр╕нр╕гр╣Мр╕Х
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н USB
- р╣Гр╕Кр╣Й `list-ports --all` р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ driver р╕Вр╕нр╕З USB-to-Serial adapter

### р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕бр╣Ир╕бр╕╡р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕нр╕╖р╣Ир╕Щр╣Гр╕Кр╣Йр╕Юр╕нр╕гр╣Мр╕Х
- р╕ер╕нр╕Зр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ timeout: `--timeout 5000`
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕ор╕▓р╕гр╣Мр╕Фр╣Бр╕зр╕гр╣М

### р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕кр╕╡р╕вр╕лр╕▓р╕в
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕▓р╕вр╕кр╕▒р╕Нр╕Нр╕▓р╕У
- р╕ер╕нр╕Зр╣Гр╕лр╕бр╣Ир╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ interference р╕Чр╕▓р╕Зр╣Др╕Яр╕Яр╣Йр╕▓

## License

Medical Device Software - SMC Project